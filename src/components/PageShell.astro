---
/**
 * Shared page shell for content-driven pages (legal, docs).
 * Loads content from a Collection entry and renders with full SEO.
 */
import BaseLayout from "../layouts/BaseLayout.astro";
import Head from "./Head.astro";
import HeroCinematic from "./HeroCinematic.astro";
import Breadcrumb from "./Breadcrumb.astro";

interface Props {
  /** Content collection entry ID (e.g. "terms", "privacy") */
  entryId: string;
  /** Show breadcrumb? (default true) */
  breadcrumb?: boolean;
}

import { getEntry, render } from "astro:content";

const { entryId, breadcrumb = true } = Astro.props;

const page = await getEntry("pages", entryId);
if (!page) throw new Error(`Missing content: pages/${entryId}.mdx`);

const { data } = page;
const { Content } = await render(page);

const heroBackground = data.hero.background ?? {
  type: "image" as const,
  src: undefined,
};
---

<BaseLayout>
  <Head
    slot="head"
    title={data.title}
    description={data.description}
    canonicalUrl={data.canonicalUrl}
    pageName={data.pageName}
    og={data.og}
    twitter={data.twitter}
    schemas={data.schemas}
  />

  <HeroCinematic
    height="60vh"
    eyebrow={data.hero.eyebrow}
    title={data.hero.title}
    subtitle={data.hero.subtitle}
    description={data.hero.description}
    ctas={data.hero.ctas}
    background={heroBackground}
  />

  {breadcrumb && <Breadcrumb pageName={data.pageName} />}

  <article class="prose-forestal mx-auto max-w-4xl px-4 py-12 lg:px-8">
    <Content />
  </article>

  <slot />
</BaseLayout>
