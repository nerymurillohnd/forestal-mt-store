---
/**
 * Shared page shell for all content-driven pages.
 * Loads content from a Collection entry and renders with full SEO.
 */
import BaseLayout from "../layouts/BaseLayout.astro";
import Head from "./Head.astro";
import Hero from "./Hero.astro";
import Breadcrumb from "./Breadcrumb.astro";

interface Props {
  /** Content collection entry ID (e.g. "home", "about") */
  entryId: string;
  /** Show breadcrumb? (false for home page) */
  breadcrumb?: boolean;
}

import { getEntry, render } from "astro:content";

const { entryId, breadcrumb = true } = Astro.props;

const page = await getEntry("pages", entryId);
if (!page) throw new Error(`Missing content: pages/${entryId}.md`);

const { data } = page;
const { Content } = await render(page);
---

<BaseLayout>
  <Head
    slot="head"
    title={data.title}
    description={data.description}
    canonicalUrl={data.canonicalUrl}
    pageName={data.pageName}
    og={data.og}
    twitter={data.twitter}
    schemas={data.schemas}
  />

  <Hero
    eyebrow={data.hero.eyebrow}
    title={data.hero.title}
    subtitle={data.hero.subtitle}
    description={data.hero.description}
    body={data.hero.body}
    ctas={data.hero.ctas}
    background={data.hero.background}
  />

  {breadcrumb && <Breadcrumb pageName={data.pageName} />}

  <article class="prose-forestal mx-auto max-w-4xl px-4 py-12 lg:px-8">
    <Content />
  </article>

  <slot />
</BaseLayout>
