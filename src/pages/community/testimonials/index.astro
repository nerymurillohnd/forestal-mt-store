---
/**
 * COMMUNITY / TESTIMONIALS — Verified customer reviews from retail buyers and wholesale partners.
 */
import BaseLayout from "../../../layouts/BaseLayout.astro";
import Head from "../../../components/Head.astro";
import Breadcrumb from "../../../components/Breadcrumb.astro";
import Hero from "../../../components/Hero.astro";
import SectionHeader from "../../../components/SectionHeader.astro";
import CollectionNav from "../../../components/CollectionNav.astro";
import { getEntry } from "astro:content";

const page = await getEntry("pages", "community/testimonials");
if (!page) throw new Error("Missing content: pages/community/testimonials");
const { data } = page;

const testimonials = [
  {
    quote:
      "I've tried four different Batana Oil suppliers over the past two years. Forestal MT is the only one that actually smells and looks like what the Honduran women use. Darker, richer, and it works. The others were cut or processed — I can tell the difference.",
    name: "Marcia T.",
    location: "Miami, FL — USA",
    product: "Raw Batana Oil",
    type: "retail",
    rating: 5,
  },
  {
    quote:
      "We import natural ingredients for a cosmetics line. Documentation was complete — COA, certificate of origin, HS codes, everything. Shipment arrived on time via DHL. We've placed three orders. No surprises, no excuses.",
    name: "Oliver B.",
    location: "London, UK",
    product: "Batana Oil — Wholesale",
    type: "wholesale",
    rating: 5,
  },
  {
    quote:
      "The Jimerito honey is unlike anything I've found at health food stores. Totally different texture, much more complex flavor, and it hasn't been filtered or heated. I use it daily. My eyes and sinuses have noticeably improved.",
    name: "Sandra R.",
    location: "Toronto, Canada",
    product: "Jimerito Honey",
    type: "retail",
    rating: 5,
  },
  {
    quote:
      "We distribute specialty botanicals in the EU. The Traditional Herbs catalog gave us 12 new SKUs we couldn't source anywhere else at this quality. The shade-drying makes a real difference in color and aroma. Our customers noticed immediately.",
    name: "Klaus H.",
    location: "Hamburg, Germany",
    product: "Traditional Herbs — Wholesale",
    type: "wholesale",
    rating: 5,
  },
  {
    quote:
      "I was skeptical of the viral Batana Oil trend. Most products I tested were diluted or substituted with African palm oil. Forestal MT is the real thing from Honduras. You can verify the sourcing — they actually answer questions about it.",
    name: "Priya N.",
    location: "Austin, TX — USA",
    product: "Raw Batana Oil",
    type: "retail",
    rating: 5,
  },
  {
    quote:
      "We run a private label herbal line and needed a direct supplier for Cat's Claw and Pau D'Arco. Forestal MT provided bulk quantities, custom packaging options, and full traceability documentation. The partnership has been straightforward from day one.",
    name: "Ana C.",
    location: "São Paulo, Brazil",
    product: "Traditional Herbs — Private Label",
    type: "wholesale",
    rating: 5,
  },
];

const aggregate = {
  rating: 5.0,
  count: testimonials.length,
};
---

<BaseLayout>
  <Head
    slot="head"
    title={data.title}
    description={data.description}
    canonicalUrl={data.canonicalUrl}
    pageName={data.pageName}
    og={data.og}
    twitter={data.twitter}
    schemas={data.schemas}
  />

  <Hero
    background={data.hero.background}
    eyebrow={data.hero.eyebrow}
    title={data.hero.title}
    subtitle={data.hero.subtitle}
    description={data.hero.description}
    ctas={data.hero.ctas}
  />

  <Breadcrumb pageName={data.pageName} parent={{ name: "Community", href: "/community/" }} />

  {/* ── AGGREGATE RATING ── */}
  <section class="surface-warm border-b border-gold/10 py-14">
    <div class="mx-auto max-w-3xl px-6 text-center lg:px-12">
      <p
        class="font-[family-name:var(--font-heading)] text-[11px] font-normal uppercase tracking-[0.35em] text-gold-dark"
      >
        Verified Reviews
      </p>
      <div class="mt-4 flex items-baseline justify-center gap-3">
        <span
          class="font-[family-name:var(--font-display)] text-[clamp(3rem,6vw,4.5rem)] font-normal leading-none text-charcoal"
          >{aggregate.rating.toFixed(1)}</span
        >
        <span
          class="font-[family-name:var(--font-heading)] text-[11px] font-normal uppercase tracking-[0.2em] text-graphite/60"
          >/ 5.0</span
        >
      </div>
      {/* Stars */}
      <div class="mt-3 flex justify-center gap-1.5">
        {
          Array.from({ length: 5 }).map(() => (
            <svg class="h-5 w-5 fill-gold" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 0 0 .95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 0 0-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 0 0-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 0 0-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 0 0 .951-.69l1.07-3.292Z" />
            </svg>
          ))
        }
      </div>
      <p
        class="mt-3 font-[family-name:var(--font-body)] text-[13px] leading-[1.85] text-graphite/50"
      >
        Based on {aggregate.count} verified reviews — retail customers and wholesale partners
      </p>
    </div>
  </section>

  {/* ── REVIEWS ── */}
  <section class="surface-parchment py-16">
    <div class="mx-auto max-w-7xl px-6 lg:px-12">
      <div class="mb-10 text-center">
        <SectionHeader eyebrow="What Buyers Say" heading="From the People Who Ordered" />
      </div>
      <div class="stagger-children grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3">
        {
          testimonials.map((t) => (
            <article class="flex flex-col border-t-[3px] border-gold/40 bg-white p-7 shadow-[0_1px_3px_rgba(0,0,0,0.04)]">
              {/* Stars */}
              <div class="flex gap-1">
                {Array.from({ length: t.rating }).map(() => (
                  <svg class="h-3.5 w-3.5 fill-gold" viewBox="0 0 20 20">
                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 0 0 .95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 0 0-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 0 0-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 0 0-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 0 0 .951-.69l1.07-3.292Z" />
                  </svg>
                ))}
              </div>
              {/* Quote */}
              <blockquote class="mt-4 flex-1 font-[family-name:var(--font-body)] text-[13.5px] leading-[1.85] text-graphite/70 before:mr-0.5 before:font-serif before:text-lg before:text-gold before:content-['\201C'] after:ml-0.5 after:font-serif after:text-lg after:text-gold after:content-['\201D']">
                {t.quote}
              </blockquote>
              <div class="mt-5 h-px w-full bg-gold/15" />
              {/* Attribution */}
              <footer class="mt-4 flex items-center justify-between gap-3">
                <div>
                  <p class="font-[family-name:var(--font-ui)] text-[12px] font-semibold text-charcoal">
                    {t.name}
                  </p>
                  <p class="font-[family-name:var(--font-ui)] text-[11px] text-graphite/50">
                    {t.location}
                  </p>
                </div>
                <span
                  class={`shrink-0 rounded-full px-2.5 py-0.5 font-[family-name:var(--font-ui)] text-[9px] font-semibold uppercase tracking-[0.15em] ${
                    t.type === "wholesale"
                      ? "bg-leaf-green/10 text-leaf-green"
                      : "bg-gold-dark/10 text-gold-dark"
                  }`}
                >
                  {t.type === "wholesale" ? "Wholesale" : "Retail"}
                </span>
              </footer>
              <p class="mt-2 font-[family-name:var(--font-heading)] text-[9px] uppercase tracking-[0.2em] text-gold-dark/60">
                {t.product}
              </p>
            </article>
          ))
        }
      </div>
    </div>
  </section>

  {/* ── CTA ── */}
  <section class="surface-dark grain relative overflow-hidden py-16">
    <div class="reveal-on-scroll relative z-10 mx-auto max-w-2xl px-6 text-center lg:px-12">
      <p
        class="font-[family-name:var(--font-heading)] text-[11px] font-normal uppercase tracking-[0.35em] text-gold/70"
      >
        Ready to order?
      </p>
      <h2
        class="mt-4 font-[family-name:var(--font-display)] text-[clamp(1.5rem,2.5vw,2rem)] font-normal text-white"
      >
        Join buyers in 20+ countries.
      </h2>
      <hr class="gold-rule" />
      <div class="mt-8 flex flex-wrap items-center justify-center gap-4">
        <a
          href="/products/"
          class="inline-block rounded-[3px] bg-gold px-7 py-3 font-[family-name:var(--font-ui)] text-[13px] font-semibold text-graphite transition-all duration-300 hover:bg-gold/90"
        >
          Shop Now
        </a>
        <a
          href="/wholesale/"
          class="inline-block rounded-[3px] border border-white/20 px-7 py-3 font-[family-name:var(--font-ui)] text-[13px] font-semibold text-white/80 transition-all duration-300 hover:border-white/40 hover:text-white"
        >
          Wholesale Program
        </a>
      </div>
    </div>
  </section>

  <CollectionNav />
</BaseLayout>
